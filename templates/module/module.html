{% extends 'base.html' %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'css/module/module.css' %}">
<div class="pc-container">
    <div class="pc-content">
        <div class="container">
            <div class="card p-4">
                <div class="d-flex flex-wrap justify-content-end align-items-center mb-3">

                    <a href="{% url 'create_module' %}">
                        <button class="btn btn-primary">+ Create Module</button>
                    </a>
                </div>
                <div class="row g-3">
                    <div class="col-md-4 col-sm-6">
                        <label class="form-label">Enter Module ID:</label>
                        <input type="text" class="form-control" placeholder="Enter Module Id">
                    </div>
                    <div class="col-md-4 col-sm-6">
                        <label class="form-label">Filter by Status:</label>
                        <select class="form-select">
                            <option>All</option>
                            <option>Pending</option>
                            <option>In Progress</option>
                            <option>Completed</option>
                        </select>
                    </div>
                    <div class="col-md-4 col-sm-6">
                        <label class="form-label">Filter by Department:</label>
                        <select class="form-select">
                            <option>All</option>
                            <option>HR</option>
                            <option>Web Development</option>
                            <option>Tester</option>
                        </select>
                    </div>
                    <div class="col-md-4 col-sm-6">
                        <label class="form-label">Filter by Assigned Manager:</label>
                        <select class="form-select">
                            <option>All</option>
                            <option>Rajesh Kumar</option>
                            <option>Pooja Sharma</option>
                            <option>Amit Verma</option>
                        </select>
                    </div>
                    <div class="col-md-4 col-sm-6">
                        <label class="form-label">Filter by Project:</label>
                        <select class="form-select">
                            <option>All</option>
                            <option>Company Management System</option>
                            <option>Task Management System</option>
                            <option>Regression Model</option>
                            <option>Classification</option>
                        </select>
                    </div>
                    <div class="col-md-4 col-sm-6 d-flex justify-content-end align-items-end">
                        <button class="btn btn-primary btn-sm me-2">Apply</button>
                        <button class="btn btn-secondary btn-sm">Reset</button>
                    </div>
                    <div class="col-md-12">
                        <!-- Main card -->
                        <div class="card p-4" id="taskStatusCard">
                            <div class="d-flex justify-content-between align-items-center">
                                <h2>Total Task Status</h2>
                                <button class="btn btn-outline-primary toggle-btn"
                                    data-target="#filterAndChartContainer">
                                    -
                                </button>
                            </div>




                            <div class="col-12 d-flex align-items-center justify-content-between mt-3">
                                <div class="d-flex align-items-center">
                                    <label for="entriesLimit" class="me-2">Show</label>
                                    <select id="entriesLimit" class="form-select form-select-sm" style="width: auto;">
                                        <option value="5">5</option>
                                        <option value="10" selected>10</option>
                                        <option value="20">20</option>
                                        <option value="50">50</option>
                                    </select>
                                    <label for="entriesLimit" class="ms-2">entries</label>
                                </div>

                            </div>
                            <!-- Task Summary Cards -->
                            <div class="row mt-4">
                                <div class="col-md-3">
                                    <div class="card bg-primary text-white p-3">
                                        <h6 class="text-dark">Total Tasks</h6>
                                        <h4>46 <span class="badge bg-light text-primary">
                                                <img src="{% static 'Png/trending up.png' %}" width="25" height="25">
                                                59.3%
                                            </span>
                                        </h4>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card bg-success text-white p-3">
                                        <h6 class="text-dark">Completed Task</h6>
                                        <h4>78 <span class="badge bg-light text-success">
                                                <img src="{% static 'Png/trending up.png' %}" width="25" height="25">
                                                70.5%
                                            </span>
                                        </h4>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card bg-danger text-dark p-3">
                                        <h6 class="text-dark">Pending Task</h6>
                                        <h4>35 <span class="badge bg-light text-danger">
                                                <img src="{% static 'Png/trending down.png' %}" width="25" height="25">
                                                27.4%
                                            </span>
                                        </h4>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="card bg-warning text-dark p-3">
                                        <h6 class="text-dark">Running Task</h6>
                                        <h4>46 <span class="badge bg-light text-warning">
                                                <img src="{% static 'Png/trending down.png' %}" width="25" height="25">
                                                59.3%
                                            </span>
                                        </h4>
                                    </div>
                                </div>
                            </div>



                            <!--
<div class="container mt-4">
<h6 class="text-muted text-end">Graph History</h6>
<div class="text-end">
    <button class="btn btn-light" data-bs-toggle="collapse" data-bs-target="#graphHistory" aria-expanded="false" aria-controls="graphHistory">
        <span>▼</span>
    </button>
</div>

Moved the collapsible section below the button
<div id="graphHistory" class="collapse mt-3">
    <div style="padding: 20px;">
        <a href="./module.html" target="_blank">
            <iframe src="" width="100%" height="300" style="border: none;"></iframe>
        </a>
    </div>
</div>
</div> -->

                            <div class="container mt-4">
                                <h6 class="text-muted text-end">Graph History</h6>
                                <div class="text-end">
                                    <button class="btn btn-light" data-bs-toggle="collapse"
                                        data-bs-target="#graphHistory" aria-expanded="false"
                                        aria-controls="graphHistory">
                                        <span>▼</span>
                                    </button>

                                    <!-- Collapsible section for graphs -->
                                    <div id="graphHistory" class="collapse mt-3">
                                        <div
                                            style="padding: 20px; display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
                                            <div style="width: 300px; height: 250px;">
                                                <h6>Bar Chart</h6>
                                                <canvas id="barChart"></canvas>
                                            </div>
                                            <div style="width: 300px; height: 250px;">
                                                <h6>Line Chart</h6>
                                                <canvas id="lineChart"></canvas>
                                            </div>
                                            <div style="width: 300px; height: 250px;">
                                                <h6>Pie Chart</h6>
                                                <canvas id="pieChart"></canvas>
                                            </div>
                                        </div>
                                    </div>


                                </div>



                                <!-- Now each module card has a distinct background color! Let me know if you want adjustments. -->
                            </div>

                            <div class="table-responsive mt-3">
                                <table class="table table-bordered table-hover">
                                    <thead style="background-color: #606364;">
                                        <tr>
                                            <th>Module ID <img src="{% static 'Png/sort.png' %}"
                                                    style="width: 16px; height: 16px; margin-left: 5px;"></th>
                                            <th>Project <img src="{% static 'Png/sort.png' %}"
                                                    style="width: 16px; height: 16px; margin-left: 5px;"></th>
                                            <th>Module Name <img src="{% static 'Png/sort.png' %}"
                                                    style="width: 16px; height: 16px; margin-left: 5px;"></th>
                                            <th>Department <img src="{% static 'Png/sort.png' %}"
                                                    style="width: 16px; height: 16px; margin-left: 5px;"></th>
                                            <th>Assigned Manager <img src="{% static 'Png/sort.png' %}"
                                                    style="width: 16px; height: 16px; margin-left: 5px;"></th>
                                            <th>Status <img src="{% static 'Png/sort.png' %}"
                                                    style="width: 16px; height: 16px; margin-left: 5px;"></th>
                                            <th>Manage <img src="{% static 'Png/sort.png' %}"
                                                    style="width: 16px; height: 16px; margin-left: 5px;"></th>
                                        </tr>
                                    </thead>

                                    <tbody>
                                        <tr>
                                            <td>101</td>
                                            <td>Company Management System</td>
                                            <td>Design Home Page</td>
                                            <td>Web Development</td>
                                            <td>Rajesh Kumar</td>
                                            <td style="width: 10px;">
                                                <div style="width: 120px;">
                                                    <select class="form-select form-select-sm status-dropdown"
                                                        onclick="openStatusPopup('101')">
                                                        <option value="in-progress" selected>In Progress</option>
                                                        <option value="completed">Completed</option>
                                                        <option value="pending">Pending</option>
                                                        <option value="hold">Hold</option>
                                                    </select>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="d-flex flex-wrap gap-2">
                                                    <a href="{% url 'show_module' %}" class="btn btn-info btn-sm">View</a>
                                                    <a href="{% url 'modify_module' %}" class="btn btn-warning btn-sm">
                                                        Modify</a>
                                                    <button class="btn btn-danger btn-sm" data-bs-toggle="modal"
                                                        data-bs-target="#deleteConfirmationModal"
                                                        data-project-id="101">Delete</button>

                                                    <div class="modal fade" id="deleteConfirmationModal" tabindex="-1"
                                                        aria-labelledby="deleteModalLabel" aria-hidden="true">
                                                        <div class="modal-dialog">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5 class="modal-title" id="deleteModalLabel">Confirm
                                                                        Deletion</h5>
                                                                    <button type="button" class="btn-close"
                                                                        data-bs-dismiss="modal" aria-label="Close"></button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    Are you sure you want to delete this Module?
                                                                </div>
                                                                <div class="modal-footer">
                                                                    <button type="button" class="btn btn-secondary"
                                                                        data-bs-dismiss="modal">Cancel</button>
                                                                    <button type="button" class="btn btn-danger"
                                                                        id="confirmDelete">Delete</button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                            </td>
                                        </tr>
                                        <tr>
                                            <td>102</td>
                                            <td>Task Management System</td>
                                            <td>Fix Login Bug</td>
                                            <td>Tester</td>
                                            <td>Pooja Sharma</td>
                                            <td style="width: 10px;">
                                                <div style="width: 120px;">
                                                    <select class="form-select form-select-sm status-dropdown"
                                                        aria-label="Status">
                                                        <option value="in-progress" selected>In Progress</option>
                                                        <option value="completed">Completed</option>
                                                        <option value="pending">Pending</option>
                                                        <option value="hold">Hold</option>
                                                    </select>
                                                </div>
                                            </td>

                                            <td>
                                                <div class="d-flex flex-wrap gap-2">
                                                    <a href="{% url 'show_module' %}" class="btn btn-info btn-sm">View</a>
                                                    <a href="{% url 'modify_module' %}" class="btn btn-warning btn-sm">
                                                        Modify</a>

                                                    <button class="btn btn-danger btn-sm" data-bs-toggle="modal"
                                                        data-bs-target="#deleteConfirmationModal"
                                                        data-project-id="101">Delete</button>
                                                </div>

                                            </td>
                                        </tr>
                                        <tr>
                                            <td>103</td>
                                            <td>Regression Model</td>
                                            <td>Update Database Schema</td>
                                            <td>HR</td>
                                            <td>Amit Verma</td>
                                            <td style="width: 10px;">
                                                <div style="width: 120px;">
                                                    <select class="form-select form-select-sm status-dropdown">
                                                        <option value="in-progress" selected>In Progress</option>
                                                        <option value="completed">Completed</option>
                                                        <option value="pending">Pending</option>
                                                        <option value="hold">Hold</option>
                                                    </select>
                                                </div>
                                            </td>
                                            <td>
                                                <div class="d-flex gap-2 align-items-center">
                                                    <a href="{% url 'show_module' %}" class="btn btn-info btn-sm">View</a>
                                                    <a href="{% url 'modify_module' %}" class="btn btn-warning btn-sm">
                                                        Modify</a>

                                                    <button class="btn btn-danger btn-sm" data-bs-toggle="modal"
                                                        data-bs-target="#deleteConfirmationModal"
                                                        data-project-id="101">Delete</button>
                                                </div>


                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <nav>
                                <ul class="pagination justify-content-center flex-wrap">
                                    <li class="page-item"><a class="page-link" href="#">Prev</a></li>
                                    <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                    <li class="page-item"><a class="page-link" href="#">2</a></li>
                                    <li class="page-item"><a class="page-link" href="#">3</a></li>
                                    <li class="page-item"><a class="page-link" href="#">Next</a></li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Status Popup Modal (Updated) -->
    <div class="modal fade" id="statusPopupModal" tabindex="-1" aria-labelledby="statusModalLabel"
        aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="statusModalLabel">Status Overview</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form>
                        <div class="mb-3">
                            <label for="statusDetails" class="form-label">Status Update:</label>
                            <p id="statusDetails" class="form-control-plaintext p-2">No status available</p>
                        </div>
                        <div class="mb-3">
                            <label for="statusComments" class="form-label">Additional Notes:</label>
                            <p id="statusComments" class="form-control-plaintext p-2">No comments available</p>
                        </div>
                        <div class="mb-3">
                            <label for="statusLastUpdated" class="form-label">Last Updated:</label>
                            <p id="statusLastUpdated" class="form-control-plaintext p-2">Not updated yet</p>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script src="{% static 'Javascript/module/module.js' %}"></script>
    {% endblock %}